const fs = require ('fs');
const csv = require('csv-parser');

function filterAndWriteData(inputFile, filterCondition, outputFile){
    const filteredData = [];

    fs.createReadStream(inputFile)
        .pipe(csv())
        .on('data', (row) =>{
            if (filterCondition(row)){
            filteredData.push(row);
            }
        })
        .on('end', () => {
            fs.writeFile(outputFile, JSON, strigify(filteredData, null, 2), (err) => {
                if (err) throw err;
                console.log(`Filtered data written to ${outputFile}`);
            });
        });        
}

//Remove canada.txt and usa.txt if they exist 
['canada.txt', 'usa.txt'].forEach((file) => {
    if (fs.existsSync(file)){
        fs.unlinkSync(file);
        console.log(`${file} deleted`);
    }
});

